swarm_datarootdir = @prefix@/share/swarm
include $(swarm_datarootdir)/Makefile.common
include $(swarm_datarootdir)/Makefile.rules

APPEXE = $(APPLICATION)@EXEEXT@
LDFLAGS = $(SWARMLDFLAGS) $(EXTRALDFLAGS)

ifneq ($(APPVERSION),)
_APPVERSION = -DAPPVERSION=$(APPVERSION)
endif
ifneq ($(BUGADDRESS),)
_BUGADDRESS = -DBUGADDRESS=$(BUGADDRESS)
endif

override CPPFLAGS += -DAPPNAME=$(APPLICATION) $(_APPVERSION) $(_BUGADDRESS)

.PHONY: install-config install-data

all: $(APPEXE)

clean:
	-rm -f $(OBJECTS) $(APPEXE) .libs/$(APPEXE) .libs/lt-$(APPEXE) $(OTHERCLEAN) core gmon.out $(APPEXE).core

install: $(APPEXE) install-config install-data
	$(SHELL) $(swarm_datarootdir)/libtool-swarm --mode install	$(INSTALL_PROGRAM) $(APPEXE) $(bindir)

install-config:
	if test -n "$(CONFIGFILES)" ; then \
	  test -d $(swarmsysconfdir)/$(APPLICATION) \
	    || mkdir $(swarmsysconfdir)/$(APPLICATION) ; \
	  $(INSTALL_DATA) $(CONFIGFILES) $(swarmsysconfdir)/$(APPLICATION) ; \
        fi

install-data:
	if test -n "$(DATAFILES)" ; then \
	  test -d $(swarmdatadir)/$(APPLICATION) \
	    || mkdir $(swarmdatadir)/$(APPLICATION) ; \
	  $(INSTALL_DATA) $(DATAFILES) $(swarmdatadir)/$(APPLICATION) ; \
        fi

$(APPEXE): $(OBJECTS)
	$(SHELL) $(swarm_datarootdir)/libtool-swarm --mode link $(CC) $(CFLAGS) $(LDFLAGS) $(GNUSTEPLIBLDFLAGS) -o $@ $(OBJECTS) $(APPLIBS) $(SWARMLIBS) $(OBJCLIBS) $(EXTRALIBS) $(GNUSTEPLIBLIBS)

# Local variables:
# mode: makefile
# End:
